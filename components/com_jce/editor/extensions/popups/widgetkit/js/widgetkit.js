WFPopups.addPopup('widgetkit',{setup:function(){var self=this;$('#widgetkit_lightbox_width').change(function(){var w=$(this).val(),$height=$('#widgetkit_lightbox_height');if($('widgetkit_lightbox_constrain').is(':checked')){var tw=$(this).data('tmp'),h=$height.val();var temp=((h/tw)*w).toFixed(0);$height.val(temp).data('tmp',temp)}$(this).data('tmp',w)});$('#widgetkit_lightbox_height').change(function(){var h=$(this).val(),$width=$('#widgetkit_lightbox_width');if($('widgetkit_lightbox_constrain').is(':checked')){var th=$(this).data('tmp'),w=$width.val();var temp=((w/th)*h).toFixed(0);$width.val(temp).data('tmp',temp)}$(this).data('tmp',h)})},check:function(n){return n.getAttribute('data-lightbox')},remove:function(n){var ed=tinyMCEPopup.editor;ed.dom.setAttrib(n,'data-lightbox','')},convertData:function(s){var a=[];$.each(s.split(';'),function(i,n){if(n){n=n.replace(/([\w]+):(.*)/,'"$1":"$2"');a.push(n)}});return $.parseJSON('{'+a.join(',')+'}')},getAttributes:function(n){var ed=tinyMCEPopup.editor,args={},v;var data=ed.dom.getAttrib(n,'data-lightbox');if(data){data=this.convertData(data)}$.each(data,function(k,v){$('#widgetkit_lightbox_'+k).val(v)});$.extend(args,{src:ed.dom.getAttrib(n,'href')});return args},setAttributes:function(n,args){var self=this,ed=tinyMCEPopup.editor;this.remove(n);var data=[];tinymce.each(['group','width','height','transitionIn','transitionOut','titlePosition','overlayShow','padding'],function(k){var v=$('#widgetkit_lightbox_'+k).val();if(v==''||v==null){if(args[k]){v=args[k]}else{return}}data.push(k+':'+v)});if(args.data){$.each(args.data,function(k,v){data.push(k+':'+v)})}ed.dom.setAttrib(n,'data-lightbox',data.join(';'));ed.dom.setAttrib(n,'target','_blank')},onSelect:function(){},onSelectFile:function(args){}});